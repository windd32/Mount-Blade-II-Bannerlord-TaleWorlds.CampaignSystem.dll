–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç dnSpy-net-win64
E:\SteamLibrary\steamapps\common\Mount & Blade II Bannerlord\bin\Win64_Shipping_Client
TaleWorlds.CampaignSystem.dll


https://forums.taleworlds.com/index.php?threads/campaign-map-speed.446410/
—Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫–µ —Ö2
–°–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–Ω–∞—á–æ–∫ –ª—É–ø—ã –≤–≤–µ—Ä—Ö—É –∏–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é ¬´–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å¬ª > ¬´–ü–æ–∏—Å–∫ —Å–±–æ—Ä–æ–∫¬ª.
–í —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ –≤–≤–µ–¥–∏—Ç–µ "SpeedUpMultiplier" –±–µ–∑ –∫–∞–≤—ã—á–µ–∫.
–©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –ø–æ SpeedUpMultiplier –≤ –æ–∫–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å".
–í –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–µ —â–µ–ª–∫–Ω–∏—Ç–µ —Å—Ç—Ä–µ–ª–∫–∏ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–µ–≥–æ—Å—è —Å–ø–∏—Å–∫–∞ ¬´–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å¬ª > ¬´–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è¬ª –∏ –¥–≤–∞–∂–¥—ã —â–µ–ª–∫–Ω–∏—Ç–µ –º–µ—Ç–æ–¥ ¬´OnLoad¬ª.
–í –º–µ—Ç–æ–¥–µ OnLoad —â–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –ø–æ —Å—Ç—Ä–æ–∫–µ –∫–æ–¥–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π "this.SpeedUpMultiplier = 4f;", –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ IL...".
–ó–∞–º–µ–Ω–∏—Ç–µ —á–∏—Å–ª–æ 4 –Ω–∞ 20 –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–û–ö¬ª –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É.
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é ¬´–§–∞–π–ª¬ª > ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥—É–ª—å¬ª –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –ó–∞–∫—Ä–æ–π—Ç–µ dnSpy, –∏ –≤—Å—ë –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å.


30 –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–æ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ 
// Token: 0x060002B6 RID: 694 RVA: 0x00014298 File Offset: 0x00012498
		[LoadInitializationCallback]
		private void OnLoad(MetaData metaData, ObjectLoadData objectLoadData)
		{
			this._campaignEntitySystem = new EntitySystem<CampaignEntityComponent>();
			this.PlayerFormationPreferences = this._playerFormationPreferences.GetReadOnlyDictionary<CharacterObject, FormationClass>();
			this.SpeedUpMultiplier = 4f;
			if (this.UniqueGameId == null && MBSaveLoad.IsUpdatingGameVersion && MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.2.2", 0))
			{
				this.UniqueGameId = "oldSave";
			}
			if (MBSaveLoad.LastLoadedGameVersion < ApplicationVersion.FromString("v1.3.0", 0))
			{
				if (this._previouslyUsedModules == null)
				{
					this._previouslyUsedModules = new MBList<string>();
				}
				MBList<string> mblist = new MBList<string>(this._previouslyUsedModules);
				this._previouslyUsedModules.Clear();
				if (Enumerable.Any<string>(mblist))
				{
					this._previouslyUsedModules.Add(string.Join(MBSaveLoad.ModuleCodeSeperator.ToString(), Enumerable.Select<string, string>(mblist, (string x) => x + MBSaveLoad.ModuleVersionSeperator.ToString() + ApplicationVersion.Empty.ToString())));
				}
			}

–±–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å(—É–∂–µ —Ö4)
// Token: 0x060002C4 RID: 708
		private void TickMapTime(float realDt)
		{
			float num = 0f;
			float speedUpMultiplier = this.SpeedUpMultiplier;
			float num2 = 2f * realDt;
			this.IsMainPartyWaiting = MobileParty.MainParty.ComputeIsWaiting();
			switch (this.TimeControlMode)
			{
			case CampaignTimeControlMode.Stop:
			case CampaignTimeControlMode.FastForwardStop:
				break;
			case CampaignTimeControlMode.UnstoppablePlay:
				num = num2;
				break;
			case CampaignTimeControlMode.UnstoppableFastForward:
			case CampaignTimeControlMode.UnstoppableFastForwardForPartyWaitTime:
				num = num2 * speedUpMultiplier;
				break;
			case CampaignTimeControlMode.StoppablePlay:
				if (!this.IsMainPartyWaiting)
				{
					num = num2;
				}
				break;
			case CampaignTimeControlMode.StoppableFastForward:
				if (!this.IsMainPartyWaiting)
				{
					num = num2 * speedUpMultiplier;
				}
				break;
			default:
				throw new ArgumentOutOfRangeException();
			}
			this._dt = num;
			this.MapTimeTracker.Tick(4320f * num);
		}

2Ô∏è‚É£ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Å—Ç–µ—Ä—Å–∫–∏—Ö
üì¶ DLL: TaleWorlds.CampaignSystem.dll
üìç –ö–ª–∞—Å—Å: DefaultWorkshopModel
üìç –ú–µ—Ç–æ–¥: GetMaxWorkshopCountForClanTier
		// Token: 0x06001EA7 RID: 7847 RVA: 0x00012DE6 File Offset: 0x00010FE6
		public override int GetMaxWorkshopCountForClanTier(int tier)
		{
			return tier + 1;
		}


–ø—Ä–æ–∫–∞—á–∫–∞
		// Token: 0x0600199F RID: 6559 RVA: 0x0009A650 File Offset: 0x00098850
		public override ExplainedNumber CalculateLearningLimit(IReadOnlyPropertyOwner<CharacterAttribute> characterAttributes, int focusValue, SkillObject skill, bool includeDescriptions = false)
		{
			float num = 0f;
			ExplainedNumber result = new ExplainedNumber(0f, includeDescriptions, null);
			foreach (CharacterAttribute attribute in skill.Attributes)
			{
				num += (float)characterAttributes.GetPropertyValue(attribute);
			}
			float num2 = num / (float)skill.Attributes.Length;
			result.Add(Math.Max(0f, (num2 - 1f) * 10f), DefaultCharacterDevelopmentModel._attributeEffectText, null);
			result.Add((float)(focusValue * 30), DefaultCharacterDevelopmentModel._skillFocusText, null);
			result.LimitMin(0f);
			return result;
		}
